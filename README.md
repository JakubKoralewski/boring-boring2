Seems to run fine now.


Build output with no link errors: cargo-build-vv-boring-sys-and-sys2.txt

Run with no runtime errors (sometimes segfaulted while developing): cargo-run.txt

# Luck

With prefix-symbols disabled this project actually compiles and works fine, my guess is linker overwrote some boringssl version with another and they were similar enough to not cause any problems (?)

# Verifying actually diferent symbol names, not just lucky

With prefix-symbols enabled.

boring-sys output dir:

[boring-sys 4.21.2] running: cd "/mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build" && CMAKE_BUILD_PARALLEL_LEVEL="8" CMAKE_PREFIX_PATH="" LC_ALL="C" "cmake" "/mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/boringssl" "-B" "/mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build" "-DCMAKE_INSTALL_PREFIX=/mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out" "-DCMAKE_C_FLAGS= -ffunction-sections -fdata-sections -fPIC -w" "-DCMAKE_C_COMPILER=/usr/bin/cc" "-DCMAKE_CXX_FLAGS= -ffunction-sections -fdata-sections -fPIC -w" "-DCMAKE_CXX_COMPILER=/usr/bin/c++" "-DCMAKE_ASM_FLAGS= -ffunction-sections -fdata-sections -fPIC -w" "-DCMAKE_ASM_COMPILER=/usr/bin/cc" "-DCMAKE_BUILD_TYPE=Debug"

/mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build


boring-sys2 output dir:

[boring-sys2 5.0.0-alpha.13] running: cd "/mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build" && CMAKE_BUILD_PARALLEL_LEVEL="8" CMAKE_PREFIX_PATH="" LC_ALL="C" "cmake" "/mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/boringssl/src" "-B" "/mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build" "-DCMAKE_POSITION_INDEPENDENT_CODE=ON" "-DCMAKE_INSTALL_PREFIX=/mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out" "-DCMAKE_C_FLAGS= -ffunction-sections -fdata-sections -fPIC -w" "-DCMAKE_C_COMPILER=/usr/bin/cc" "-DCMAKE_CXX_FLAGS= -ffunction-sections -fdata-sections -fPIC -w" "-DCMAKE_CXX_COMPILER=/usr/bin/c++" "-DCMAKE_ASM_FLAGS= -ffunction-sections -fdata-sections -fPIC -w" "-DCMAKE_ASM_COMPILER=/usr/bin/cc" "-DCMAKE_BUILD_TYPE=Debug"

/mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build

## Generating symbol names: nm -a

[username@vm-instance-hostname boring-boring2]$ nm -a /mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build/libssl.a > symbols/boring-sys/libssl-a-nm-a.txt
[username@vm-instance-hostname boring-boring2]$ nm -a /mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build/libcrypto.a > symbols/boring-sys/libcrypto-a-nm-a.txt

[username@vm-instance-hostname boring-boring2]$ nm -a /mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build/ssl/libssl.a > symbols/boring-sys2/libssl-a-nm-a.txt
[username@vm-instance-hostname boring-boring2]$ nm -a /mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build/crypto/libcrypto.a > symbols/boring-sys2/libcrypto-a-nm-a.txt

# Saving generated libraries

[username@vm-instance-hostname boring-boring2]$ cp /mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build/libssl.a symbols/boring-sys/libssl.a
[username@vm-instance-hostname boring-boring2]$ cp /mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build/libcrypto.a symbols/boring-sys/libcrypto.a
[username@vm-instance-hostname boring-boring2]$ cp /mnt/vol/.cargo/target/debug/build/boring-sys-3d663635f58136fa/out/build/libcrypto.a symbols/boring-sys/libcrypto.a^C
[username@vm-instance-hostname boring-boring2]$ cp /mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build/ssl/libssl.a symbols/boring-sys2/libssl.a
[username@vm-instance-hostname boring-boring2]$ cp /mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build/ssl/libcrypto.a symbols/boring-sys2/libcrypto.a
cp: cannot stat '/mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build/ssl/libcrypto.a': No such file or directory
[username@vm-instance-hostname boring-boring2]$ cp /mnt/vol/.cargo/target/debug/build/boring-sys2-acf1d96c91ebc630/out/build/crypto/libcrypto.a symbols/boring-sys2/libcrypto.a

# Finding global symbols that are unprefixed

[username@vm-instance-hostname boring-boring2]$ nm -g symbols/boring-sys2/libssl.a > symbols/boring-sys2/libssl-globals.txt
[username@vm-instance-hostname boring-boring2]$ nm -g symbols/boring-sys2/libcrypto.a > symbols/boring-sys2/libcrypto-globals.txt


[username@vm-instance-hostname boring-boring2]$ grep -v b2 symbols/boring-sys2/libssl-globals.txt > symbols/boring-sys2/libssl-globals-nob2.txt
[username@vm-instance-hostname boring-boring2]$ grep -v b2 symbols/boring-sys2/libcrypto-globals.txt > symbols/borin
g-sys2/libcrypto-globals-nob2.txt

## Analysis

U - Undefined - from libc - not a problem
W - Weak - generated by C++ std - unlikely to be a problem

T D R B - potential problems

### Are there any T D R B s ?


[username@vm-instance-hostname boring-boring2]$ grep -E ' [TDRB] ' sym
bols/boring-sys2/libssl-globals-nob2.txt

[username@vm-instance-hostname boring-boring2]$ grep -E ' [TDRB] ' symbols/boring-sys2/libcrypto-globals-nob2.txt


#### No.
